<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nrepesh - AI Hug Me Admin Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MX5E36LSJ8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MX5E36LSJ8');
    </script>
    
    <style>
        :root {
            --primary: #ff6b6b;
            --secondary: #6a11cb;
            --accent: #2575fc;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        
        .admin-container {
            width: 100%;
            max-width: 1400px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 15px 0;
        }
        
        .admin-header {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .admin-header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .admin-header p {
            font-size: 0.95rem;
            opacity: 0.9;
        }
        
        .admin-nav {
            background: var(--light);
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            overflow-x: auto;
        }
        
        .nav-tabs {
            display: flex;
            gap: 8px;
            flex-wrap: nowrap;
            min-width: max-content;
        }
        
        .nav-tab {
            padding: 10px 16px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .nav-tab.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .admin-content {
            padding: 20px;
            min-height: 500px;
        }
        
        .admin-panel {
            display: none;
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-left: 4px solid var(--secondary);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary);
            margin: 8px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            height: 300px;
        }
        
        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 600;
        }
        
        .table-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow-x: auto;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--secondary);
            outline: none;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #ff5252;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-sm {
            padding: 8px 14px;
            font-size: 0.9rem;
        }
        
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .login-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--secondary);
        }
        
        .error-message {
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 10px 12px;
            border-radius: 8px;
            margin: 12px 0;
            font-size: 0.9rem;
        }
        
        .success-message {
            background-color: rgba(40, 167, 69, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
            padding: 10px 12px;
            border-radius: 8px;
            margin: 12px 0;
            font-size: 0.9rem;
        }
        
        .hidden {
            display: none !important;
        }
        
        .recent-activity {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .activity-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .activity-icon {
            font-size: 1.3rem;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-time {
            color: #666;
            font-size: 0.85rem;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ad-slots-container {
            margin-top: 15px;
        }
        
        .ad-slot-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            border-left: 4px solid var(--secondary);
        }
        
        .ad-slot-header {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .ad-slot-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .ad-rate-display {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--success);
            margin: 8px 0;
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .badge-success {
            background: var(--success);
            color: white;
        }
        
        .badge-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .badge-danger {
            background: var(--danger);
            color: white;
        }
        
        .auto-activate-notice {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.85rem;
        }
        
        .ad-slot-preview {
            background: #f8f9fa;
            border: 2px dashed #6a11cb;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .ad-preview-title {
            font-weight: bold;
            color: #6a11cb;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .network-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
            margin-left: 6px;
        }
        
        .network-google { background: #4285F4; color: white; }
        .network-facebook { background: #1877F2; color: white; }
        .network-direct { background: #666; color: white; }
        .network-custom { background: #FF6B6B; color: white; }
        
        .timer-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
            margin-left: 6px;
            background: #28a745;
            color: white;
        }
        
        .html-editor {
            width: 100%;
            min-height: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.85rem;
        }
        
        .page-editor {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .page-editor textarea {
            width: 100%;
            min-height: 150px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
            font-size: 0.85rem;
        }

        /* Ad Preview Styles */
        .ad-preview-minimal {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 6px;
            margin: 4px 0;
            font-size: 0.75rem;
            color: #6c757d;
            opacity: 0.7;
        }
        
        .ad-preview-minimal .ad-title {
            font-weight: bold;
            color: #495057;
        }
        
        .ad-preview-minimal .ad-network {
            font-size: 0.65rem;
            color: #868e96;
        }
        
        .firebase-status {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 8px;
        }
        
        .real-time-badge {
            background: #dc3545;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .admin-power-badge {
            background: linear-gradient(135deg, #ff6b6b, #6a11cb);
            color: white;
            padding: 3px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
        }
        
        .user-activity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin: 12px 0;
        }
        
        .user-activity-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--secondary);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            animation: spin 1s linear infinite;
            margin: 8px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Enhanced Ad Management Styles */
        .ad-management {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .ad-slot-editor {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .ad-slot-item {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .ad-slot-inputs {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }
        
        .ad-slot-actions {
            display: flex;
            gap: 5px;
        }
        
        .ad-preview {
            background: #f8f9fa;
            border: 2px dashed #6a11cb;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .ad-preview h4 {
            color: #6a11cb;
            margin-bottom: 10px;
        }
        
        .revenue-source-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            border-left: 4px solid var(--secondary);
        }
        
        .revenue-source-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .revenue-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .revenue-stat {
            background: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        
        .revenue-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--success);
        }
        
        .revenue-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .ad-schedule-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
        }
        
        .schedule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .schedule-dates {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .popup-settings {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .popup-trigger-options {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }
        
        .popup-trigger-option {
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }
        
        .popup-trigger-option.active {
            border-color: var(--secondary);
            background: rgba(106, 17, 203, 0.1);
        }
        
        .image-preview-container {
            margin: 10px 0;
            text-align: center;
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
        }
        
        .ad-rotation-settings {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .rotation-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }
        
        .rotation-weight {
            width: 60px;
        }
        
        .rotation-preview {
            flex: 1;
        }
        
        /* Mobile-First Responsive Design */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .admin-container {
                margin: 10px 0;
                border-radius: 15px;
            }
            
            .admin-header {
                padding: 15px;
            }
            
            .admin-header h1 {
                font-size: 1.5rem;
            }
            
            .admin-nav {
                padding: 10px;
            }
            
            .nav-tab {
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            
            .admin-content {
                padding: 15px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-value {
                font-size: 1.7rem;
            }
            
            .chart-container {
                padding: 15px;
                height: 250px;
            }
            
            .table-container {
                padding: 15px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .login-container {
                margin: 30px auto;
                padding: 25px;
            }
            
            .login-title {
                font-size: 1.5rem;
            }
            
            .user-activity-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .ad-slot-inputs {
                grid-template-columns: 1fr;
            }
            
            .ad-slot-item {
                flex-direction: column;
                align-items: stretch;
            }
            
            .ad-slot-actions {
                justify-content: center;
                margin-top: 10px;
            }
            
            .popup-trigger-options {
                grid-template-columns: 1fr;
            }
            
            .schedule-dates {
                grid-template-columns: 1fr;
            }
            
            .revenue-stats {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (min-width: 768px) {
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr 1fr;
            }
            
            .ad-slot-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .user-activity-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .ad-slot-inputs {
                grid-template-columns: 1fr 1fr 1fr;
            }
            
            .popup-trigger-options {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }
        
        @media (min-width: 1024px) {
            .admin-nav {
                overflow-x: visible;
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        /* Extra small devices */
        @media (max-width: 360px) {
            .admin-header h1 {
                font-size: 1.3rem;
            }
            
            .nav-tab {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
            
            .user-activity-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 200px;
            }
        }
        
        /* Quick Action Buttons */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .quick-action-btn {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .quick-action-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        /* Search and Filter */
        .search-filter {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            margin: 15px 0;
        }
        
        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .data-table th,
        .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .nav-tabs {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                border: 1px solid #ddd;
                border-radius: 8px;
                z-index: 1000;
                margin: 0 15px;
            }
            
            .nav-tabs.show {
                display: flex;
            }
            
            .nav-tab {
                border: none;
                border-bottom: 1px solid #eee;
                border-radius: 0;
            }
            
            .nav-tab:last-child {
                border-bottom: none;
            }
        }
    </style>
</head>
<body>
    <div id="loginPage" class="login-container">
        <h1 class="login-title">🔒 Nrepesh Admin</h1>
        <div class="error-message hidden" id="loginError">
            Invalid password! Please try "admin123"
        </div>
        <div class="form-group">
            <input type="password" id="adminPassword" class="form-control" placeholder="Enter admin password" value="admin123">
        </div>
        <button class="btn btn-primary" id="loginBtn" style="width: 100%;">Login</button>
        <p style="margin-top: 15px; color: #666; font-size: 0.85rem;">
            Default password: <strong>admin123</strong>
        </p>
        <div style="margin-top: 12px; padding: 8px; background: #f8f9fa; border-radius: 5px;">
            <span class="real-time-badge">LIVE</span>
        </div>
    </div>
    
    <div id="adminPage" class="admin-container hidden">
        <div class="admin-header">
            <h1>Nrepesh - AI Hug Me Admin 
                <span class="admin-power-badge">SUPER ADMIN</span>
            </h1>
            <p>Complete Control & Real-time Analytics Dashboard</p>
        </div>
        
        <div class="admin-nav">
            <button class="mobile-menu-toggle" id="mobileMenuToggle">☰ Menu</button>
            <div class="nav-tabs" id="navTabs">
                <div class="nav-tab active" data-tab="dashboard">📊 Dashboard</div>
                <div class="nav-tab" data-tab="siteControl">⚙️ Site Control</div>
                <div class="nav-tab" data-tab="adManagement">💰 Ad Management</div>
                <div class="nav-tab" data-tab="footerControl">🦶 Footer Control</div>
                <div class="nav-tab" data-tab="pages">📄 Page Content</div>
                <div class="nav-tab" data-tab="analytics">📈 Analytics</div>
                <div class="nav-tab" data-tab="users">👥 Users</div>
                <button class="btn btn-danger" id="logoutBtn" style="margin-left: auto;">Logout</button>
            </div>
        </div>
        
        <div class="admin-content">
            <!-- Real-time Dashboard Panel -->
            <div id="dashboard" class="admin-panel active">
                <div class="quick-actions">
                    <div class="quick-action-btn" onclick="switchTab('siteControl')">
                        ⚙️ Site Settings
                    </div>
                    <div class="quick-action-btn" onclick="switchTab('adManagement')">
                        💰 Ad Management
                    </div>
                    <div class="quick-action-btn" onclick="switchTab('footerControl')">
                        🦶 Footer Settings
                    </div>
                    <div class="quick-action-btn" onclick="refreshStats()">
                        🔄 Refresh Stats
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Hugs Generated</div>
                        <div class="stat-value" id="totalHugs">0</div>
                        <div class="real-time-badge">LIVE</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Users Now</div>
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="real-time-badge">REAL-TIME</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Today's Revenue</div>
                        <div class="stat-value" id="todayRevenue">$0.00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Avg. Session Time</div>
                        <div class="stat-value" id="avgSessionTime">0s</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">Real-time Hug Activity <span class="real-time-badge">LIVE</span></div>
                    <canvas id="realtimeChart"></canvas>
                </div>
                
                <div class="table-container">
                    <div class="chart-title">Live User Activity <span class="real-time-badge">UPDATING</span></div>
                    <div class="user-activity-grid" id="liveUserActivity">
                        <div class="user-activity-card">
                            <div class="loading-spinner"></div>
                            <div style="font-size: 0.8rem;">Loading activities...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Site Control Panel - ENHANCED -->
            <div id="siteControl" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">Super Admin Control Panel</div>
                    
                    <div class="form-group">
                        <label>Site Title</label>
                        <input type="text" class="form-control" id="siteTitle" value="AI Hug Me">
                    </div>
                    
                    <div class="form-group">
                        <label>Site Tagline</label>
                        <input type="text" class="form-control" id="siteTagline" value="Get a completely AI-powered virtual hug!">
                    </div>
                    
                    <div class="form-group">
                        <label>Theme Color</label>
                        <select class="form-control" id="themeColor">
                            <option value="default">Default (Pink)</option>
                            <option value="blue">Blue Theme</option>
                            <option value="green">Green Theme</option>
                            <option value="purple">Purple Theme</option>
                            <option value="dark">Dark Theme</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Admin Power Controls</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableSpecialEvents" checked>
                                <label for="enableSpecialEvents">Enable Special Events</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableSocialSharing" checked>
                                <label for="enableSocialSharing">Enable Social Sharing</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableViralFeatures" checked>
                                <label for="enableViralFeatures">Enable Viral Features</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableUserTracking" checked>
                                <label for="enableUserTracking">Enable User Tracking</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Super Admin Password</label>
                        <input type="password" class="form-control" id="newPassword" placeholder="Enter new admin password">
                    </div>
                    
                    <div class="quick-actions">
                        <button class="btn btn-success" id="applySettings">Apply Settings</button>
                        <button class="btn btn-primary" id="resetSettings">Reset Defaults</button>
                        <button class="btn btn-warning" id="clearAllData">Clear Data</button>
                        <button class="btn btn-danger" id="emergencyShutdown">Emergency Stop</button>
                    </div>
                    
                    <div class="success-message hidden" id="settingsSuccess">
                        Settings applied successfully!
                    </div>
                </div>
            </div>
            
            <!-- Enhanced Ad Management Panel -->
            <div id="adManagement" class="admin-panel">
                <div class="ad-management">
                    <div class="chart-title">💰 Enterprise Ad Management System</div>
                    
                    <div class="auto-activate-notice">
                        ✅ <strong>AD MANAGEMENT:</strong> Complete control over all revenue sources and ad placements!
                    </div>
                    
                    <!-- Revenue Sources Management -->
                    <div class="form-group">
                        <label>Revenue Sources Configuration</label>
                        <div class="revenue-source-item">
                            <div class="revenue-source-header">
                                <h4>Google AdSense</h4>
                                <span class="badge badge-success">Active</span>
                            </div>
                            <div class="form-group">
                                <label>AdSense Publisher ID</label>
                                <input type="text" class="form-control" id="adsensePublisherId" placeholder="pub-XXXXXXXXXXXX">
                            </div>
                            <div class="revenue-stats">
                                <div class="revenue-stat">
                                    <div class="revenue-value">$12.45</div>
                                    <div class="revenue-label">Today</div>
                                </div>
                                <div class="revenue-stat">
                                    <div class="revenue-value">$89.23</div>
                                    <div class="revenue-label">This Week</div>
                                </div>
                                <div class="revenue-stat">
                                    <div class="revenue-value">$342.67</div>
                                    <div class="revenue-label">This Month</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="revenue-source-item">
                            <div class="revenue-source-header">
                                <h4>Direct Ads</h4>
                                <span class="badge badge-success">Active</span>
                            </div>
                            <div class="form-group">
                                <label>Default CPM Rate</label>
                                <input type="number" class="form-control" id="defaultCpmRate" value="2.50" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Direct Advertisers</label>
                                <textarea class="form-control" id="directAdvertisers" placeholder="List of direct advertisers..."></textarea>
                            </div>
                        </div>
                        
                        <div class="revenue-source-item">
                            <div class="revenue-source-header">
                                <h4>Affiliate Marketing</h4>
                                <span class="badge badge-warning">Setup Required</span>
                            </div>
                            <div class="form-group">
                                <label>Affiliate Networks</label>
                                <select class="form-control" id="affiliateNetworks" multiple>
                                    <option value="amazon">Amazon Associates</option>
                                    <option value="clickbank">ClickBank</option>
                                    <option value="cj">Commission Junction</option>
                                    <option value="shareasale">ShareASale</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ad Slot Management -->
                    <div class="form-group">
                        <label>Dynamic Ad Slot Management</label>
                        <div class="ad-slot-editor">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Slot Name</label>
                                    <input type="text" class="form-control" id="slotName" placeholder="Header Banner">
                                </div>
                                <div class="form-group">
                                    <label>Slot Type</label>
                                    <select class="form-control" id="slotType">
                                        <option value="header">Header Banner</option>
                                        <option value="sidebar">Sidebar</option>
                                        <option value="footer">Footer</option>
                                        <option value="in-content">In-Content</option>
                                        <option value="popup">Popup</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Dimensions</label>
                                    <input type="text" class="form-control" id="slotDimensions" placeholder="728x90">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>CPM Rate ($)</label>
                                    <input type="number" class="form-control" id="slotCpmRate" value="3.50" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label>Priority</label>
                                    <select class="form-control" id="slotPriority">
                                        <option value="high">High</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="low">Low</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Status</label>
                                    <select class="form-control" id="slotStatus">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                            
                            <button class="btn btn-success" id="addSlotBtn">Add Ad Slot</button>
                        </div>
                        
                        <div class="ad-slots-container" id="adSlotsContainer">
                            <!-- Ad slots will be dynamically added here -->
                        </div>
                    </div>
                    
                    <!-- External Image Link Management -->
                    <div class="form-group">
                        <label>External Image Link Management</label>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Image URL</label>
                                <input type="url" class="form-control" id="externalImageUrl" placeholder="https://example.com/image.jpg">
                            </div>
                            <div class="form-group">
                                <label>Destination URL</label>
                                <input type="url" class="form-control" id="destinationUrl" placeholder="https://example.com">
                            </div>
                        </div>
                        
                        <div class="image-preview-container">
                            <div class="image-preview" id="imagePreview">
                                Image preview will appear here
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <button class="btn btn-primary" id="previewImageBtn">Preview Image</button>
                            <button class="btn btn-success" id="saveImageBtn">Save Image Ad</button>
                        </div>
                    </div>
                    
                    <!-- Ad Scheduling -->
                    <div class="form-group">
                        <label>Ad Scheduling & Rotation</label>
                        <div class="ad-schedule-item">
                            <div class="schedule-header">
                                <h4>Schedule Settings</h4>
                                <span class="badge badge-success">Active</span>
                            </div>
                            <div class="schedule-dates">
                                <div class="form-group">
                                    <label>Start Date/Time</label>
                                    <input type="datetime-local" class="form-control" id="scheduleStart">
                                </div>
                                <div class="form-group">
                                    <label>End Date/Time</label>
                                    <input type="datetime-local" class="form-control" id="scheduleEnd">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Rotation Type</label>
                                <select class="form-control" id="rotationType">
                                    <option value="equal">Equal Rotation</option>
                                    <option value="weighted">Weighted Rotation</option>
                                    <option value="priority">Priority-based</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Popup Ad Management -->
                    <div class="form-group">
                        <label>Popup Ad Management</label>
                        <div class="popup-settings">
                            <div class="form-group">
                                <label>Popup Trigger</label>
                                <div class="popup-trigger-options">
                                    <div class="popup-trigger-option active" data-trigger="entry">
                                        Entry Popup
                                    </div>
                                    <div class="popup-trigger-option" data-trigger="exit-intent">
                                        Exit-Intent Popup
                                    </div>
                                    <div class="popup-trigger-option" data-trigger="timed">
                                        Timed Popup
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Popup Delay (seconds)</label>
                                <input type="number" class="form-control" id="popupDelay" value="5" min="0">
                            </div>
                            
                            <div class="form-group">
                                <label>Frequency Capping (per user)</label>
                                <input type="number" class="form-control" id="popupFrequency" value="1" min="1">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Revenue Analytics -->
                    <div class="form-group">
                        <label>Revenue Analytics Dashboard</label>
                        <div class="chart-container">
                            <div class="chart-title">Revenue Sources Breakdown</div>
                            <canvas id="revenueChart"></canvas>
                        </div>
                        
                        <div class="revenue-stats">
                            <div class="revenue-stat">
                                <div class="revenue-value">$342.67</div>
                                <div class="revenue-label">Total Revenue</div>
                            </div>
                            <div class="revenue-stat">
                                <div class="revenue-value">$12.45</div>
                                <div class="revenue-label">Today</div>
                            </div>
                            <div class="revenue-stat">
                                <div class="revenue-value">3.2%</div>
                                <div class="revenue-label">CTR</div>
                            </div>
                            <div class="revenue-stat">
                                <div class="revenue-value">$8.76</div>
                                <div class="revenue-label">RPM</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="quick-actions">
                        <button class="btn btn-success" id="saveAdSettings">Save All Settings</button>
                        <button class="btn btn-primary" id="exportAdData">Export Data</button>
                        <button class="btn btn-warning" id="resetAdSettings">Reset to Defaults</button>
                    </div>
                </div>
            </div>
            
            <!-- Footer Control Panel -->
            <div id="footerControl" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">Footer Content Management</div>
                    
                    <div class="form-group">
                        <label>Footer Text</label>
                        <textarea class="form-control" id="footerText" rows="3">© 2023 AI Hug Me. All rights reserved. Made with ❤️ by Nrepesh</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Social Media Links</label>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="url" class="form-control" id="facebookUrl" placeholder="Facebook URL">
                            </div>
                            <div class="form-group">
                                <input type="url" class="form-control" id="twitterUrl" placeholder="Twitter URL">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="url" class="form-control" id="instagramUrl" placeholder="Instagram URL">
                            </div>
                            <div class="form-group">
                                <input type="url" class="form-control" id="linkedinUrl" placeholder="LinkedIn URL">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Quick Links</label>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" class="form-control" id="link1Text" placeholder="Link 1 Text">
                            </div>
                            <div class="form-group">
                                <input type="url" class="form-control" id="link1Url" placeholder="Link 1 URL">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" class="form-control" id="link2Text" placeholder="Link 2 Text">
                            </div>
                            <div class="form-group">
                                <input type="url" class="form-control" id="link2Url" placeholder="Link 2 URL">
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" id="saveFooterBtn">Save Footer Settings</button>
                    
                    <div class="success-message hidden" id="footerSuccess">
                        Footer settings saved successfully!
                    </div>
                </div>
            </div>
            
            <!-- Page Content Management Panel -->
            <div id="pages" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">Page Content Management</div>
                    
                    <div class="form-group">
                        <label>Select Page</label>
                        <select class="form-control" id="pageSelector">
                            <option value="home">Home Page</option>
                            <option value="about">About Page</option>
                            <option value="contact">Contact Page</option>
                            <option value="privacy">Privacy Policy</option>
                            <option value="terms">Terms of Service</option>
                        </select>
                    </div>
                    
                    <div class="page-editor">
                        <div class="form-group">
                            <label>Page Title</label>
                            <input type="text" class="form-control" id="pageTitle" value="AI Hug Me - Get Your Virtual Hug">
                        </div>
                        
                        <div class="form-group">
                            <label>Page Content (HTML)</label>
                            <textarea class="form-control" id="pageContent" rows="10">
<div class="hero-section">
    <h1>Get an AI-Powered Virtual Hug!</h1>
    <p>Experience the warmth of a virtual hug powered by artificial intelligence.</p>
    <button class="hug-button">Get Your Hug Now</button>
</div>
                            </textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Meta Description</label>
                            <textarea class="form-control" id="metaDescription" rows="2">Get a completely AI-powered virtual hug! Experience warmth and comfort with our AI technology.</textarea>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" id="savePageBtn">Save Page Content</button>
                    
                    <div class="success-message hidden" id="pageSuccess">
                        Page content saved successfully!
                    </div>
                </div>
            </div>
            
            <!-- Analytics Panel -->
            <div id="analytics" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">Advanced Analytics Dashboard</div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Total Page Views</div>
                            <div class="stat-value">12,458</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Unique Visitors</div>
                            <div class="stat-value">8,742</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Bounce Rate</div>
                            <div class="stat-value">32.5%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Avg. Session</div>
                            <div class="stat-value">2m 45s</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">Traffic Sources</div>
                        <canvas id="trafficChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">User Demographics</div>
                        <canvas id="demographicsChart"></canvas>
                    </div>
                    
                    <div class="table-container">
                        <div class="chart-title">Recent Activity</div>
                        <div class="recent-activity">
                            <div class="activity-item">
                                <div class="activity-icon">📊</div>
                                <div class="activity-content">
                                    <strong>User from United States</strong> viewed the home page
                                </div>
                                <div class="activity-time">2 minutes ago</div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">🤗</div>
                                <div class="activity-content">
                                    <strong>User from India</strong> received a virtual hug
                                </div>
                                <div class="activity-time">5 minutes ago</div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">💰</div>
                                <div class="activity-content">
                                    <strong>Ad revenue</strong> generated from Google AdSense
                                </div>
                                <div class="activity-time">12 minutes ago</div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">📱</div>
                                <div class="activity-content">
                                    <strong>Mobile user</strong> from Brazil visited the site
                                </div>
                                <div class="activity-time">18 minutes ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Users Management Panel -->
            <div id="users" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">User Management</div>
                    
                    <div class="search-filter">
                        <input type="text" class="form-control" id="userSearch" placeholder="Search users...">
                        <button class="btn btn-primary">Search</button>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Hugs</th>
                                <th>Last Active</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#001</td>
                                <td>John Doe</td>
                                <td>john@example.com</td>
                                <td>12</td>
                                <td>2 hours ago</td>
                                <td>
                                    <button class="btn btn-sm btn-primary">View</button>
                                    <button class="btn btn-sm btn-danger">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td>#002</td>
                                <td>Jane Smith</td>
                                <td>jane@example.com</td>
                                <td>8</td>
                                <td>5 hours ago</td>
                                <td>
                                    <button class="btn btn-sm btn-primary">View</button>
                                    <button class="btn btn-sm btn-danger">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td>#003</td>
                                <td>Bob Johnson</td>
                                <td>bob@example.com</td>
                                <td>15</td>
                                <td>1 day ago</td>
                                <td>
                                    <button class="btn btn-sm btn-primary">View</button>
                                    <button class="btn btn-sm btn-danger">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="form-group" style="margin-top: 15px;">
                        <button class="btn btn-success">Add New User</button>
                        <button class="btn btn-warning">Export Users</button>
                        <button class="btn btn-danger">Delete All Users</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const adminPage = document.getElementById('adminPage');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const adminPassword = document.getElementById('adminPassword');
        const loginError = document.getElementById('loginError');
        const navTabs = document.querySelectorAll('.nav-tab');
        const adminPanels = document.querySelectorAll('.admin-panel');
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const navTabsContainer = document.getElementById('navTabs');
        
        // Enhanced Ad Management Elements
        const addSlotBtn = document.getElementById('addSlotBtn');
        const adSlotsContainer = document.getElementById('adSlotsContainer');
        const previewImageBtn = document.getElementById('previewImageBtn');
        const saveImageBtn = document.getElementById('saveImageBtn');
        const imagePreview = document.getElementById('imagePreview');
        const externalImageUrl = document.getElementById('externalImageUrl');
        const popupTriggerOptions = document.querySelectorAll('.popup-trigger-option');
        
        // Chart variables
        let realtimeChart, revenueChart, trafficChart, demographicsChart;
        
        // Demo data for charts
        const demoData = {
            realtime: [12, 19, 3, 5, 2, 3, 15, 12, 8, 10, 14, 18],
            revenue: [120, 190, 300, 500, 200, 300, 450, 320, 480, 390, 420, 550],
            traffic: [40, 30, 20, 10],
            demographics: [30, 25, 20, 15, 10]
        };
        
        // Initialize the application
        function init() {
            // Check if user is already logged in
            if (localStorage.getItem('adminLoggedIn') === 'true') {
                showAdminPage();
            }
            
            // Set up event listeners
            setupEventListeners();
            
            // Initialize charts
            initCharts();
            
            // Load initial data
            loadInitialData();
            
            // Start real-time updates
            startRealTimeUpdates();
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            // Login functionality
            loginBtn.addEventListener('click', handleLogin);
            adminPassword.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            // Logout functionality
            logoutBtn.addEventListener('click', handleLogout);
            
            // Navigation tabs
            navTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Mobile menu toggle
            mobileMenuToggle.addEventListener('click', () => {
                navTabsContainer.classList.toggle('show');
            });
            
            // Enhanced Ad Management
            addSlotBtn.addEventListener('click', addAdSlot);
            previewImageBtn.addEventListener('click', previewExternalImage);
            saveImageBtn.addEventListener('click', saveImageAd);
            
            // Popup trigger options
            popupTriggerOptions.forEach(option => {
                option.addEventListener('click', () => {
                    popupTriggerOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                });
            });
            
            // Save buttons
            document.getElementById('applySettings').addEventListener('click', saveSiteSettings);
            document.getElementById('saveFooterBtn').addEventListener('click', saveFooterSettings);
            document.getElementById('savePageBtn').addEventListener('click', savePageContent);
            document.getElementById('saveAdSettings').addEventListener('click', saveAdSettings);
            
            // Reset buttons
            document.getElementById('resetSettings').addEventListener('click', resetSiteSettings);
            document.getElementById('resetAdSettings').addEventListener('click', resetAdSettings);
            
            // Emergency buttons
            document.getElementById('emergencyShutdown').addEventListener('click', emergencyShutdown);
            document.getElementById('clearAllData').addEventListener('click', clearAllData);
            
            // Export buttons
            document.getElementById('exportAdData').addEventListener('click', exportAdData);
        }
        
        // Handle user login
        function handleLogin() {
            const password = adminPassword.value;
            
            // Simple password check (in real app, this would be more secure)
            if (password === 'admin123') {
                localStorage.setItem('adminLoggedIn', 'true');
                showAdminPage();
            } else {
                loginError.classList.remove('hidden');
            }
        }
        
        // Handle user logout
        function handleLogout() {
            localStorage.removeItem('adminLoggedIn');
            showLoginPage();
        }
        
        // Show admin page after successful login
        function showAdminPage() {
            loginPage.classList.add('hidden');
            adminPage.classList.remove('hidden');
            
            // Refresh data when showing admin page
            refreshStats();
        }
        
        // Show login page
        function showLoginPage() {
            loginPage.classList.remove('hidden');
            adminPage.classList.add('hidden');
            adminPassword.value = '';
            loginError.classList.add('hidden');
        }
        
        // Switch between admin panels
        function switchTab(tabName) {
            // Update active tab
            navTabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // Show active panel
            adminPanels.forEach(panel => {
                if (panel.id === tabName) {
                    panel.classList.add('active');
                } else {
                    panel.classList.remove('active');
                }
            });
            
            // Hide mobile menu after selection
            if (window.innerWidth <= 768) {
                navTabsContainer.classList.remove('show');
            }
            
            // Refresh data for specific tabs
            if (tabName === 'dashboard') {
                refreshStats();
            } else if (tabName === 'analytics') {
                updateAnalyticsCharts();
            }
        }
        
        // Initialize charts
        function initCharts() {
            // Real-time chart
            const realtimeCtx = document.getElementById('realtimeChart').getContext('2d');
            realtimeChart = new Chart(realtimeCtx, {
                type: 'line',
                data: {
                    labels: ['12:00', '12:05', '12:10', '12:15', '12:20', '12:25', '12:30', '12:35', '12:40', '12:45', '12:50', '12:55'],
                    datasets: [{
                        label: 'Hugs per 5 min',
                        data: demoData.realtime,
                        borderColor: '#6a11cb',
                        backgroundColor: 'rgba(106, 17, 203, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Revenue chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(revenueCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Google AdSense', 'Direct Ads', 'Affiliate', 'Programmatic'],
                    datasets: [{
                        data: [45, 30, 15, 10],
                        backgroundColor: [
                            '#4285F4',
                            '#34A853',
                            '#FBBC05',
                            '#EA4335'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Traffic sources chart
            const trafficCtx = document.getElementById('trafficChart').getContext('2d');
            trafficChart = new Chart(trafficCtx, {
                type: 'pie',
                data: {
                    labels: ['Direct', 'Social Media', 'Search Engines', 'Referrals'],
                    datasets: [{
                        data: demoData.traffic,
                        backgroundColor: [
                            '#6a11cb',
                            '#2575fc',
                            '#ff6b6b',
                            '#28a745'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Demographics chart
            const demographicsCtx = document.getElementById('demographicsChart').getContext('2d');
            demographicsChart = new Chart(demographicsCtx, {
                type: 'bar',
                data: {
                    labels: ['18-24', '25-34', '35-44', '45-54', '55+'],
                    datasets: [{
                        label: 'Users by Age',
                        data: demoData.demographics,
                        backgroundColor: '#6a11cb'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // Load initial data
        function loadInitialData() {
            // Load saved settings if available
            const savedSettings = localStorage.getItem('siteSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('siteTitle').value = settings.siteTitle || 'AI Hug Me';
                document.getElementById('siteTagline').value = settings.siteTagline || 'Get a completely AI-powered virtual hug!';
            }
            
            // Load saved ad slots
            const savedAdSlots = localStorage.getItem('adSlots');
            if (savedAdSlots) {
                const slots = JSON.parse(savedAdSlots);
                slots.forEach(slot => renderAdSlot(slot));
            }
        }
        
        // Refresh dashboard stats
        function refreshStats() {
            // Simulate API calls to get real data
            document.getElementById('totalHugs').textContent = Math.floor(Math.random() * 1000) + 500;
            document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 50) + 10;
            document.getElementById('todayRevenue').textContent = '$' + (Math.random() * 50 + 10).toFixed(2);
            document.getElementById('avgSessionTime').textContent = Math.floor(Math.random() * 120 + 30) + 's';
            
            // Update real-time chart with new data
            const newData = demoData.realtime.map(value => value + Math.floor(Math.random() * 10 - 5));
            realtimeChart.data.datasets[0].data = newData;
            realtimeChart.update();
            
            // Update live user activity
            updateLiveUserActivity();
        }
        
        // Update live user activity
        function updateLiveUserActivity() {
            const activities = [
                { icon: '🤗', text: 'User from United States received a virtual hug', time: 'Just now' },
                { icon: '📱', text: 'Mobile user from India visited the site', time: '1 min ago' },
                { icon: '💰', text: 'Ad revenue generated from Direct Ads', time: '2 mins ago' },
                { icon: '🌍', text: 'User from Brazil shared a hug on social media', time: '3 mins ago' }
            ];
            
            const activityContainer = document.getElementById('liveUserActivity');
            activityContainer.innerHTML = '';
            
            activities.forEach(activity => {
                const activityCard = document.createElement('div');
                activityCard.className = 'user-activity-card';
                activityCard.innerHTML = `
                    <div style="font-size: 1.5rem;">${activity.icon}</div>
                    <div style="font-size: 0.85rem; margin-top: 5px;">${activity.text}</div>
                    <div style="font-size: 0.7rem; color: #666; margin-top: 5px;">${activity.time}</div>
                `;
                activityContainer.appendChild(activityCard);
            });
        }
        
        // Start real-time updates
        function startRealTimeUpdates() {
            // Update stats every 10 seconds
            setInterval(refreshStats, 10000);
            
            // Update charts every 30 seconds
            setInterval(updateAnalyticsCharts, 30000);
        }
        
        // Update analytics charts
        function updateAnalyticsCharts() {
            // Simulate updating chart data
            const newRevenueData = demoData.revenue.map(value => value + Math.floor(Math.random() * 100 - 50));
            revenueChart.data.datasets[0].data = newRevenueData;
            revenueChart.update();
            
            const newTrafficData = demoData.traffic.map(value => value + Math.floor(Math.random() * 10 - 5));
            trafficChart.data.datasets[0].data = newTrafficData;
            trafficChart.update();
            
            const newDemographicsData = demoData.demographics.map(value => value + Math.floor(Math.random() * 5 - 2));
            demographicsChart.data.datasets[0].data = newDemographicsData;
            demographicsChart.update();
        }
        
        // Enhanced Ad Management Functions
        
        // Add a new ad slot
        function addAdSlot() {
            const slotName = document.getElementById('slotName').value;
            const slotType = document.getElementById('slotType').value;
            const slotDimensions = document.getElementById('slotDimensions').value;
            const slotCpmRate = document.getElementById('slotCpmRate').value;
            const slotPriority = document.getElementById('slotPriority').value;
            const slotStatus = document.getElementById('slotStatus').value;
            
            if (!slotName || !slotDimensions) {
                alert('Please fill in all required fields');
                return;
            }
            
            const slot = {
                id: Date.now(),
                name: slotName,
                type: slotType,
                dimensions: slotDimensions,
                cpmRate: slotCpmRate,
                priority: slotPriority,
                status: slotStatus,
                createdAt: new Date().toISOString()
            };
            
            // Save to localStorage
            const savedSlots = localStorage.getItem('adSlots');
            const slots = savedSlots ? JSON.parse(savedSlots) : [];
            slots.push(slot);
            localStorage.setItem('adSlots', JSON.stringify(slots));
            
            // Render the slot
            renderAdSlot(slot);
            
            // Clear form
            document.getElementById('slotName').value = '';
            document.getElementById('slotDimensions').value = '';
        }
        
        // Render an ad slot in the UI
        function renderAdSlot(slot) {
            const slotElement = document.createElement('div');
            slotElement.className = 'ad-slot-item';
            slotElement.innerHTML = `
                <div class="ad-slot-header">
                    <div>
                        <strong>${slot.name}</strong>
                        <span class="badge ${slot.status === 'active' ? 'badge-success' : 'badge-warning'}">${slot.status}</span>
                        <span class="network-badge network-direct">${slot.type}</span>
                    </div>
                    <div class="ad-rate-display">$${slot.cpmRate} CPM</div>
                </div>
                <div class="ad-slot-details">
                    <div>Dimensions: ${slot.dimensions}</div>
                    <div>Priority: ${slot.priority}</div>
                    <div>Created: ${new Date(slot.createdAt).toLocaleDateString()}</div>
                </div>
                <div class="ad-slot-actions">
                    <button class="btn btn-sm btn-primary" onclick="editAdSlot(${slot.id})">Edit</button>
                    <button class="btn btn-sm btn-warning" onclick="toggleAdSlot(${slot.id})">${slot.status === 'active' ? 'Deactivate' : 'Activate'}</button>
                    <button class="btn btn-sm btn-danger" onclick="deleteAdSlot(${slot.id})">Delete</button>
                </div>
            `;
            
            adSlotsContainer.appendChild(slotElement);
        }
        
        // Preview external image
        function previewExternalImage() {
            const imageUrl = externalImageUrl.value;
            
            if (!imageUrl) {
                alert('Please enter an image URL');
                return;
            }
            
            imagePreview.innerHTML = `<img src="${imageUrl}" alt="Ad Preview" class="image-preview" onerror="this.style.display='none'; imagePreview.innerHTML='Failed to load image. Please check the URL.'">`;
        }
        
        // Save image ad
        function saveImageAd() {
            const imageUrl = externalImageUrl.value;
            const destinationUrl = document.getElementById('destinationUrl').value;
            
            if (!imageUrl || !destinationUrl) {
                alert('Please fill in both image URL and destination URL');
                return;
            }
            
            // In a real app, this would save to a database
            alert('Image ad saved successfully!');
            
            // Clear form
            externalImageUrl.value = '';
            document.getElementById('destinationUrl').value = '';
            imagePreview.innerHTML = 'Image preview will appear here';
        }
        
        // Save site settings
        function saveSiteSettings() {
            const settings = {
                siteTitle: document.getElementById('siteTitle').value,
                siteTagline: document.getElementById('siteTagline').value,
                themeColor: document.getElementById('themeColor').value,
                enableSpecialEvents: document.getElementById('enableSpecialEvents').checked,
                enableSocialSharing: document.getElementById('enableSocialSharing').checked,
                enableViralFeatures: document.getElementById('enableViralFeatures').checked,
                enableUserTracking: document.getElementById('enableUserTracking').checked
            };
            
            // Save to localStorage
            localStorage.setItem('siteSettings', JSON.stringify(settings));
            
            // Show success message
            const successMessage = document.getElementById('settingsSuccess');
            successMessage.classList.remove('hidden');
            setTimeout(() => {
                successMessage.classList.add('hidden');
            }, 3000);
        }
        
        // Save footer settings
        function saveFooterSettings() {
            // In a real app, this would save to a database
            const successMessage = document.getElementById('footerSuccess');
            successMessage.classList.remove('hidden');
            setTimeout(() => {
                successMessage.classList.add('hidden');
            }, 3000);
        }
        
        // Save page content
        function savePageContent() {
            // In a real app, this would save to a database
            const successMessage = document.getElementById('pageSuccess');
            successMessage.classList.remove('hidden');
            setTimeout(() => {
                successMessage.classList.add('hidden');
            }, 3000);
        }
        
        // Save ad settings
        function saveAdSettings() {
            // In a real app, this would save all ad settings to a database
            alert('All ad settings saved successfully!');
        }
        
        // Reset site settings to defaults
        function resetSiteSettings() {
            if (confirm('Are you sure you want to reset all site settings to defaults?')) {
                document.getElementById('siteTitle').value = 'AI Hug Me';
                document.getElementById('siteTagline').value = 'Get a completely AI-powered virtual hug!';
                document.getElementById('themeColor').value = 'default';
                document.getElementById('enableSpecialEvents').checked = true;
                document.getElementById('enableSocialSharing').checked = true;
                document.getElementById('enableViralFeatures').checked = true;
                document.getElementById('enableUserTracking').checked = true;
                
                localStorage.removeItem('siteSettings');
                
                alert('Site settings have been reset to defaults.');
            }
        }
        
        // Reset ad settings to defaults
        function resetAdSettings() {
            if (confirm('Are you sure you want to reset all ad settings to defaults?')) {
                document.getElementById('adsensePublisherId').value = '';
                document.getElementById('defaultCpmRate').value = '2.50';
                document.getElementById('directAdvertisers').value = '';
                
                // Clear ad slots
                adSlotsContainer.innerHTML = '';
                localStorage.removeItem('adSlots');
                
                alert('Ad settings have been reset to defaults.');
            }
        }
        
        // Emergency shutdown
        function emergencyShutdown() {
            if (confirm('EMERGENCY: This will disable all site features. Are you sure?')) {
                alert('Emergency shutdown activated. All site features have been disabled.');
                // In a real app, this would trigger an API call to disable the site
            }
        }
        
        // Clear all data
        function clearAllData() {
            if (confirm('WARNING: This will delete ALL data including users, analytics, and settings. This cannot be undone. Are you sure?')) {
                localStorage.clear();
                alert('All data has been cleared. The page will now reload.');
                location.reload();
            }
        }
        
        // Export ad data
        function exportAdData() {
            alert('Ad data exported successfully!');
            // In a real app, this would generate and download a CSV file
        }
        
        // Ad slot management functions (stubs for demo)
        function editAdSlot(id) {
            alert(`Editing ad slot with ID: ${id}`);
        }
        
        function toggleAdSlot(id) {
            alert(`Toggling ad slot with ID: ${id}`);
        }
        
        function deleteAdSlot(id) {
            if (confirm('Are you sure you want to delete this ad slot?')) {
                alert(`Deleted ad slot with ID: ${id}`);
            }
        }
        
        // Initialize the application when the page loads
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
