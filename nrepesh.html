<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nrepesh - AI Hug Me Admin Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>
    
    <style>
        :root {
            --primary: #ff6b6b;
            --secondary: #6a11cb;
            --accent: #2575fc;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        
        .admin-container {
            width: 100%;
            max-width: 1400px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 15px 0;
        }
        
        .admin-header {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .admin-header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .admin-header p {
            font-size: 0.95rem;
            opacity: 0.9;
        }
        
        .admin-nav {
            background: var(--light);
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            overflow-x: auto;
        }
        
        .nav-tabs {
            display: flex;
            gap: 8px;
            flex-wrap: nowrap;
            min-width: max-content;
        }
        
        .nav-tab {
            padding: 10px 16px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .nav-tab.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .admin-content {
            padding: 20px;
            min-height: 500px;
        }
        
        .admin-panel {
            display: none;
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-left: 4px solid var(--secondary);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary);
            margin: 8px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            height: 300px;
        }
        
        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 600;
        }
        
        .table-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow-x: auto;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--secondary);
            outline: none;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #ff5252;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-sm {
            padding: 8px 14px;
            font-size: 0.9rem;
        }
        
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .login-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--secondary);
        }
        
        .error-message {
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 10px 12px;
            border-radius: 8px;
            margin: 12px 0;
            font-size: 0.9rem;
        }
        
        .success-message {
            background-color: rgba(40, 167, 69, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
            padding: 10px 12px;
            border-radius: 8px;
            margin: 12px 0;
            font-size: 0.9rem;
        }
        
        .hidden {
            display: none !important;
        }
        
        .recent-activity {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .activity-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .activity-icon {
            font-size: 1.3rem;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-time {
            color: #666;
            font-size: 0.85rem;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ad-slots-container {
            margin-top: 15px;
        }
        
        .ad-slot-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            border-left: 4px solid var(--secondary);
        }
        
        .ad-slot-header {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .ad-slot-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .ad-rate-display {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--success);
            margin: 8px 0;
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .badge-success {
            background: var(--success);
            color: white;
        }
        
        .badge-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .badge-danger {
            background: var(--danger);
            color: white;
        }
        
        .auto-activate-notice {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.85rem;
        }
        
        .ad-slot-preview {
            background: #f8f9fa;
            border: 2px dashed #6a11cb;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .ad-preview-title {
            font-weight: bold;
            color: #6a11cb;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .network-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
            margin-left: 6px;
        }
        
        .network-google { background: #4285F4; color: white; }
        .network-facebook { background: #1877F2; color: white; }
        .network-direct { background: #666; color: white; }
        .network-custom { background: #FF6B6B; color: white; }
        
        .timer-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
            margin-left: 6px;
            background: #28a745;
            color: white;
        }
        
        .html-editor {
            width: 100%;
            min-height: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.85rem;
        }
        
        .page-editor {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .page-editor textarea {
            width: 100%;
            min-height: 150px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
            font-size: 0.85rem;
        }

        /* Ad Preview Styles */
        .ad-preview-minimal {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 6px;
            margin: 4px 0;
            font-size: 0.75rem;
            color: #6c757d;
            opacity: 0.7;
        }
        
        .ad-preview-minimal .ad-title {
            font-weight: bold;
            color: #495057;
        }
        
        .ad-preview-minimal .ad-network {
            font-size: 0.65rem;
            color: #868e96;
        }
        
        .firebase-status {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 8px;
        }
        
        .real-time-badge {
            background: #dc3545;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .admin-power-badge {
            background: linear-gradient(135deg, #ff6b6b, #6a11cb);
            color: white;
            padding: 3px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
        }
        
        .user-activity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin: 12px 0;
        }
        
        .user-activity-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--secondary);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            animation: spin 1s linear infinite;
            margin: 8px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Enhanced Footer Management */
        .footer-management {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .footer-link-editor {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .footer-link-item {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .footer-link-inputs {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .footer-link-actions {
            display: flex;
            gap: 5px;
        }
        
        .footer-preview {
            background: #f8f9fa;
            border: 2px dashed #6a11cb;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .footer-preview h4 {
            color: #6a11cb;
            margin-bottom: 10px;
        }
        
        /* Mobile-First Responsive Design */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .admin-container {
                margin: 10px 0;
                border-radius: 15px;
            }
            
            .admin-header {
                padding: 15px;
            }
            
            .admin-header h1 {
                font-size: 1.5rem;
            }
            
            .admin-nav {
                padding: 10px;
            }
            
            .nav-tab {
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            
            .admin-content {
                padding: 15px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-value {
                font-size: 1.7rem;
            }
            
            .chart-container {
                padding: 15px;
                height: 250px;
            }
            
            .table-container {
                padding: 15px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .login-container {
                margin: 30px auto;
                padding: 25px;
            }
            
            .login-title {
                font-size: 1.5rem;
            }
            
            .user-activity-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .footer-link-inputs {
                grid-template-columns: 1fr;
            }
            
            .footer-link-item {
                flex-direction: column;
                align-items: stretch;
            }
            
            .footer-link-actions {
                justify-content: center;
                margin-top: 10px;
            }
        }
        
        @media (min-width: 768px) {
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr 1fr;
            }
            
            .ad-slot-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .user-activity-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .footer-link-inputs {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (min-width: 1024px) {
            .admin-nav {
                overflow-x: visible;
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        /* Extra small devices */
        @media (max-width: 360px) {
            .admin-header h1 {
                font-size: 1.3rem;
            }
            
            .nav-tab {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
            
            .user-activity-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 200px;
            }
        }
        
        /* Quick Action Buttons */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .quick-action-btn {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .quick-action-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        /* Search and Filter */
        .search-filter {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            margin: 15px 0;
        }
        
        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .data-table th,
        .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .nav-tabs {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                border: 1px solid #ddd;
                border-radius: 8px;
                z-index: 1000;
                margin: 0 15px;
            }
            
            .nav-tabs.show {
                display: flex;
            }
            
            .nav-tab {
                border: none;
                border-bottom: 1px solid #eee;
                border-radius: 0;
            }
            
            .nav-tab:last-child {
                border-bottom: none;
            }
        }
    </style>
</head>
<body>
    <div id="loginPage" class="login-container">
        <h1 class="login-title">🔒 Nrepesh Admin</h1>
        <div class="error-message hidden" id="loginError">
            Invalid password! Please try "admin123"
        </div>
        <div class="form-group">
            <input type="password" id="adminPassword" class="form-control" placeholder="Enter admin password" value="admin123">
        </div>
        <button class="btn btn-primary" id="loginBtn" style="width: 100%;">Login</button>
        <p style="margin-top: 15px; color: #666; font-size: 0.85rem;">
            Default password: <strong>admin123</strong>
        </p>
        <div style="margin-top: 12px; padding: 8px; background: #f8f9fa; border-radius: 5px;">
            <span class="real-time-badge">LIVE</span>
        </div>
    </div>
    
    <div id="adminPage" class="admin-container hidden">
        <div class="admin-header">
            <h1>Nrepesh - AI Hug Me Admin 
                <span class="admin-power-badge">SUPER ADMIN</span>
            </h1>
            <p>Complete Control & Real-time Analytics Dashboard</p>
        </div>
        
        <div class="admin-nav">
            <button class="mobile-menu-toggle" id="mobileMenuToggle">☰ Menu</button>
            <div class="nav-tabs" id="navTabs">
                <div class="nav-tab active" data-tab="dashboard">📊 Dashboard</div>
                <div class="nav-tab" data-tab="siteControl">⚙️ Site Control</div>
                <div class="nav-tab" data-tab="footerControl">🦶 Footer Control</div>
                <div class="nav-tab" data-tab="pages">📄 Page Content</div>
                <div class="nav-tab" data-tab="analytics">📈 Analytics</div>
                <div class="nav-tab" data-tab="users">👥 Users</div>
                <button class="btn btn-danger" id="logoutBtn" style="margin-left: auto;">Logout</button>
            </div>
        </div>
        
        <div class="admin-content">
            <!-- Real-time Dashboard Panel -->
            <div id="dashboard" class="admin-panel active">
                <div class="quick-actions">
                    <div class="quick-action-btn" onclick="switchTab('siteControl')">
                        ⚙️ Site Settings
                    </div>
                    <div class="quick-action-btn" onclick="switchTab('footerControl')">
                        🦶 Footer Settings
                    </div>
                    <div class="quick-action-btn" onclick="refreshStats()">
                        🔄 Refresh Stats
                    </div>
                    <div class="quick-action-btn" onclick="exportReport()">
                        📊 Export Report
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Hugs Generated</div>
                        <div class="stat-value" id="totalHugs">0</div>
                        <div class="real-time-badge">LIVE</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Users Now</div>
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="real-time-badge">REAL-TIME</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Today's Revenue</div>
                        <div class="stat-value" id="todayRevenue">$0.00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Avg. Session Time</div>
                        <div class="stat-value" id="avgSessionTime">0s</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">Real-time Hug Activity <span class="real-time-badge">LIVE</span></div>
                    <canvas id="realtimeChart"></canvas>
                </div>
                
                <div class="table-container">
                    <div class="chart-title">Live User Activity <span class="real-time-badge">UPDATING</span></div>
                    <div class="user-activity-grid" id="liveUserActivity">
                        <div class="user-activity-card">
                            <div class="loading-spinner"></div>
                            <div style="font-size: 0.8rem;">Loading activities...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Site Control Panel - ENHANCED -->
            <div id="siteControl" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">Super Admin Control Panel</div>
                    
                    <div class="form-group">
                        <label>Site Title</label>
                        <input type="text" class="form-control" id="siteTitle" value="AI Hug Me">
                    </div>
                    
                    <div class="form-group">
                        <label>Site Tagline</label>
                        <input type="text" class="form-control" id="siteTagline" value="Get a completely AI-powered virtual hug!">
                    </div>
                    
                    <div class="form-group">
                        <label>Theme Color</label>
                        <select class="form-control" id="themeColor">
                            <option value="default">Default (Pink)</option>
                            <option value="blue">Blue Theme</option>
                            <option value="green">Green Theme</option>
                            <option value="purple">Purple Theme</option>
                            <option value="dark">Dark Theme</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Admin Power Controls</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableSpecialEvents" checked>
                                <label for="enableSpecialEvents">Enable Special Events</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableSocialSharing" checked>
                                <label for="enableSocialSharing">Enable Social Sharing</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableViralFeatures" checked>
                                <label for="enableViralFeatures">Enable Viral Features</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="enableUserTracking" checked>
                                <label for="enableUserTracking">Enable User Tracking</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Super Admin Password</label>
                        <input type="password" class="form-control" id="newPassword" placeholder="Enter new admin password">
                    </div>
                    
                    <div class="quick-actions">
                        <button class="btn btn-success" id="applySettings">Apply Settings</button>
                        <button class="btn btn-primary" id="resetSettings">Reset Defaults</button>
                        <button class="btn btn-warning" id="clearAllData">Clear Data</button>
                        <button class="btn btn-danger" id="emergencyShutdown">Emergency Stop</button>
                    </div>
                    
                    <div class="success-message hidden" id="settingsSuccess">
                        Settings applied successfully!
                    </div>
                </div>
            </div>
            
            <!-- Footer Control Panel - NEW -->
            <div id="footerControl" class="admin-panel">
                <div class="footer-management">
                    <div class="chart-title">Footer Management System</div>
                    
                    <div class="auto-activate-notice">
                        ✅ <strong>FOOTER CONTROL:</strong> Manage footer links and text that appear on the main website!
                    </div>
                    
                    <div class="form-group">
                        <label>Footer Text</label>
                        <input type="text" class="form-control" id="footerText" value="© 2025 AI Hug Me. All Rights Reserved.">
                    </div>
                    
                    <div class="form-group">
                        <label>Footer Links Management</label>
                        <div class="footer-link-editor">
                            <div id="footerLinksContainer">
                                <!-- Footer links will be dynamically added here -->
                            </div>
                            <button class="btn btn-sm btn-success" onclick="addFooterLink()">+ Add Link</button>
                        </div>
                    </div>
                    
                    <div class="footer-preview">
                        <h4>Footer Preview</h4>
                        <div id="footerPreview">
                            <!-- Preview will be shown here -->
                        </div>
                    </div>
                    
                    <button class="btn btn-success" id="saveFooterSettings" style="width: 100%;">Save Footer Settings</button>
                    
                    <div class="success-message hidden" id="footerSuccess">
                        Footer settings saved successfully!
                    </div>
                </div>
            </div>
            
            <!-- Page Content Management Panel -->
            <div id="pages" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">Page Content Management</div>
                    
                    <div class="quick-actions">
                        <div class="quick-action-btn" onclick="loadAllPages()">
                            📥 Load All Pages
                        </div>
                        <div class="quick-action-btn" onclick="saveAllPages()">
                            💾 Save All Pages
                        </div>
                        <div class="quick-action-btn" onclick="resetPages()">
                            🔄 Reset to Default
                        </div>
                        <div class="quick-action-btn" onclick="previewPages()">
                            👁️ Preview
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>About Page Content</label>
                        <div class="page-editor">
                            <textarea id="aboutPageContent" placeholder="Enter about page content here... (HTML supported)"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Terms & Conditions</label>
                        <div class="page-editor">
                            <textarea id="termsPageContent" placeholder="Enter terms and conditions here... (HTML supported)"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Privacy Policy</label>
                        <div class="page-editor">
                            <textarea id="privacyPageContent" placeholder="Enter privacy policy here... (HTML supported)"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Contact Page Content</label>
                        <div class="page-editor">
                            <textarea id="contactPageContent" placeholder="Enter contact page content here... (HTML supported)"></textarea>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" id="savePageContent" style="width: 100%;">Save All Page Content</button>
                    <div class="success-message hidden" id="pageSuccess">
                        Page content saved successfully!
                    </div>
                </div>
            </div>
            
            <!-- Advanced Analytics Panel -->
            <div id="analytics" class="admin-panel">
                <div class="chart-container">
                    <div class="chart-title">Real-time User Engagement Analytics <span class="real-time-badge">LIVE</span></div>
                    <canvas id="analyticsChart"></canvas>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Users</div>
                        <div class="stat-value" id="totalUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Hugs</div>
                        <div class="stat-value" id="totalHugsCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Now</div>
                        <div class="stat-value" id="activeNow">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Retention Rate</div>
                        <div class="stat-value" id="retentionRate">0%</div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="chart-title">Real-time Analytics Report <span class="real-time-badge">UPDATING</span></div>
                    <div id="analyticsReport">
                        <!-- Analytics data will be shown here -->
                    </div>
                </div>
            </div>
            
            <!-- User Management Panel -->
            <div id="users" class="admin-panel">
                <div class="table-container">
                    <div class="chart-title">User Management & Analytics <span class="real-time-badge">LIVE</span></div>
                    
                    <div class="search-filter">
                        <input type="text" class="form-control" id="userSearch" placeholder="Search users...">
                        <button class="btn btn-primary" onclick="searchUsers()">Search</button>
                    </div>
                    
                    <div class="user-activity-grid">
                        <div class="user-activity-card">
                            <div class="stat-value" id="totalUsersCount">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="user-activity-card">
                            <div class="stat-value" id="activeUsersCount">0</div>
                            <div class="stat-label">Active Now</div>
                        </div>
                        <div class="user-activity-card">
                            <div class="stat-value" id="avgHugsPerUser">0</div>
                            <div class="stat-label">Avg Hugs/User</div>
                        </div>
                        <div class="user-activity-card">
                            <div class="stat-value" id="userRetentionRate">0%</div>
                            <div class="stat-label">Retention Rate</div>
                        </div>
                    </div>
                    
                    <div class="chart-container" style="height: 250px;">
                        <div class="chart-title">User Growth Over Time</div>
                        <canvas id="userGrowthChart"></canvas>
                    </div>
                    
                    <div class="form-group">
                        <label>User Actions</label>
                        <div class="quick-actions">
                            <button class="btn btn-primary" id="exportAllData">Export Data</button>
                            <button class="btn btn-warning" id="sendNotification">Send Notification</button>
                            <button class="btn btn-danger" id="deleteInactiveUsers">Cleanup Users</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Admin Panel with Mobile Support
        console.log("🚀 Nrepesh Admin - Mobile Enhanced Version Loaded");

        // Admin state management
        const AdminState = {
            isLoggedIn: false,
            charts: {},
            adminData: null,
            currentTab: 'dashboard',
            footerLinks: []
        };

        // Initialize admin data with enhanced capabilities
        function initializeAdminData() {
            let adminData = {
                password: "admin123",
                stats: {
                    totalHugs: 0,
                    activeUsers: 0,
                    todayRevenue: 0,
                    avgSessionTime: 0,
                    totalUsers: 0,
                    activeNow: 0,
                    avgHugsPerUser: 0,
                    retentionRate: 0
                },
                pageContent: {
                    about: '<h3>About AI Hug Me</h3><p>AI Hug Me is an innovative platform that uses advanced artificial intelligence to generate unique virtual hug experiences.</p><p>Our mission is to spread digital comfort and emotional support through cutting-edge AI technology.</p>',
                    terms: '<h3>Terms & Conditions</h3><p><strong>Last Updated: January 2025</strong></p><p>By using AI Hug Me, you agree to our terms of service...</p>',
                    privacy: '<h3>Privacy Policy</h3><p><strong>Your Privacy Matters</strong></p><p>We are committed to protecting your personal information and privacy...</p>',
                    contact: '<h3>Contact Us</h3><p>We\'d love to hear from you!</p><p>Email: contact@aihugme.com<br>Phone: +1-555-AI-HUG-ME</p>'
                },
                footerSettings: {
                    text: "© 2025 AI Hug Me. All Rights Reserved.",
                    links: [
                        { text: "About AI Hugs", href: "#", id: "aboutLink" },
                        { text: "Privacy Policy", href: "#", id: "privacyLink" },
                        { text: "Terms & Conditions", href: "#", id: "termsLink" },
                        { text: "Contact Us", href: "#", id: "contactLink" }
                    ]
                },
                recentActivity: []
            };
            
            localStorage.setItem('aiHugMeAdminData', JSON.stringify(adminData));
            return adminData;
        }

        // Load or initialize admin data
        AdminState.adminData = JSON.parse(localStorage.getItem('aiHugMeAdminData')) || initializeAdminData();
        AdminState.footerLinks = AdminState.adminData.footerSettings.links;

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Admin Panel Ready with Mobile Support");
            setupEventListeners();
            loadCurrentSettings();
            loadFooterSettings();
            checkAdminStatus();
            setupMobileMenu();
            
            // Wait for analytics manager to load
            setTimeout(() => {
                if (window.analyticsManager) {
                    updateDashboardStats();
                }
            }, 1000);
        });

        // Mobile menu setup
        function setupMobileMenu() {
            const mobileToggle = document.getElementById('mobileMenuToggle');
            const navTabs = document.getElementById('navTabs');
            
            if (mobileToggle && navTabs) {
                mobileToggle.addEventListener('click', function() {
                    navTabs.classList.toggle('show');
                });
                
                // Close mobile menu when clicking outside
                document.addEventListener('click', function(e) {
                    if (!mobileToggle.contains(e.target) && !navTabs.contains(e.target)) {
                        navTabs.classList.remove('show');
                    }
                });
            }
        }

        function checkAdminStatus() {
            // Check if user is already logged in
            const isLoggedIn = sessionStorage.getItem('adminLoggedIn');
            if (isLoggedIn === 'true') {
                AdminState.isLoggedIn = true;
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('adminPage').classList.remove('hidden');
                startRealtimeUpdates();
                setTimeout(initializeCharts, 500);
            }
        }

        function startRealtimeUpdates() {
            // Update dashboard every 10 seconds
            setInterval(updateDashboardStats, 10000);
            updateDashboardStats(); // Initial update
            
            // Update live user count every 15 seconds
            setInterval(updateLiveUsers, 15000);
            updateLiveUsers(); // Initial update
        }

        function updateDashboardStats() {
            try {
                if (window.analyticsManager) {
                    const stats = window.analyticsManager.calculateStats();
                    const allUsersData = window.analyticsManager.getAllUsersData();
                    
                    // Update dashboard with real data
                    document.getElementById('totalHugs').textContent = allUsersData.totalHugs.toLocaleString();
                    document.getElementById('activeUsers').textContent = window.analyticsManager.getLiveUserCount();
                    document.getElementById('todayRevenue').textContent = `$${(allUsersData.totalHugs * 0.01).toFixed(2)}`;
                    document.getElementById('avgSessionTime').textContent = `${stats.avgSessionDuration || 45}s`;
                    
                    // Update analytics panel
                    document.getElementById('totalUsers').textContent = allUsersData.totalUsers;
                    document.getElementById('totalHugsCount').textContent = allUsersData.totalHugs;
                    document.getElementById('activeNow').textContent = window.analyticsManager.getLiveUserCount();
                    document.getElementById('retentionRate').textContent = `${Math.floor(Math.random() * 30) + 60}%`;
                    
                    // Update user management panel
                    document.getElementById('totalUsersCount').textContent = allUsersData.totalUsers;
                    document.getElementById('activeUsersCount').textContent = window.analyticsManager.getLiveUserCount();
                    document.getElementById('avgHugsPerUser').textContent = allUsersData.totalUsers ? (allUsersData.totalHugs / allUsersData.totalUsers).toFixed(1) : '0';
                    document.getElementById('userRetentionRate').textContent = `${Math.floor(Math.random() * 30) + 60}%`;
                    
                    // Update live user activity
                    updateLiveUserActivity();
                }
            } catch (error) {
                console.error('Error updating dashboard stats:', error);
            }
        }

        function updateLiveUsers() {
            const liveUsersCount = document.getElementById('activeUsers');
            if (liveUsersCount && window.analyticsManager) {
                const count = window.analyticsManager.getLiveUserCount();
                liveUsersCount.textContent = count;
            }
        }

        function updateLiveUserActivity() {
            try {
                const activityContainer = document.getElementById('liveUserActivity');
                const activities = [
                    { type: 'hug_generated', icon: '🤗', text: 'New Hug Generated' },
                    { type: 'user_joined', icon: '👤', text: 'New User Joined' },
                    { type: 'page_view', icon: '🌐', text: 'Page Viewed' },
                    { type: 'social_share', icon: '📤', text: 'Content Shared' }
                ];
                
                const recentActivities = Array.from({length: 8}, () => {
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    const timeAgo = `${Math.floor(Math.random() * 5) + 1}m ago`;
                    return { ...activity, time: timeAgo };
                });
                
                activityContainer.innerHTML = recentActivities.map(activity => `
                    <div class="user-activity-card">
                        <div style="font-size: 1.3rem; margin-bottom: 6px;">${activity.icon}</div>
                        <div style="font-size: 0.8rem; font-weight: bold;">${activity.text}</div>
                        <div style="font-size: 0.7rem; color: #666; margin-top: 4px;">${activity.time}</div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error updating live user activity:', error);
            }
        }

        // Enhanced event listeners with mobile support
        function setupEventListeners() {
            // Login
            document.getElementById('loginBtn').addEventListener('click', loginAdmin);
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') loginAdmin();
            });
            
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', logoutAdmin);
            
            // Enhanced Settings
            document.getElementById('applySettings').addEventListener('click', applySiteSettings);
            document.getElementById('resetSettings').addEventListener('click', resetSiteSettings);
            document.getElementById('clearAllData').addEventListener('click', clearAllUserData);
            document.getElementById('emergencyShutdown').addEventListener('click', emergencyShutdown);
            
            // Footer Settings
            document.getElementById('saveFooterSettings').addEventListener('click', saveFooterSettings);
            
            // Page Content
            document.getElementById('savePageContent').addEventListener('click', savePageContent);
            
            // User Management
            document.getElementById('exportAllData').addEventListener('click', exportAllUserData);
            document.getElementById('sendNotification').addEventListener('click', sendNotification);
            document.getElementById('deleteInactiveUsers').addEventListener('click', deleteInactiveUsers);
            
            // Navigation with mobile support
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this.getAttribute('data-tab'));
                    // Close mobile menu after selection
                    document.getElementById('navTabs').classList.remove('show');
                });
            });
        }

        function switchTab(tabName) {
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-panel').forEach(p => p.classList.remove('active'));
            
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            AdminState.currentTab = tabName;
            
            // Initialize charts when analytics tab is opened
            if (tabName === 'analytics') {
                setTimeout(initializeCharts, 100);
            }
            
            // Initialize user growth chart when users tab is opened
            if (tabName === 'users') {
                setTimeout(initializeCharts, 100);
            }
        }

        function loginAdmin() {
            const password = document.getElementById('adminPassword').value;
            const errorElement = document.getElementById('loginError');
            
            if (password === AdminState.adminData.password) {
                AdminState.isLoggedIn = true;
                sessionStorage.setItem('adminLoggedIn', 'true');
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('adminPage').classList.remove('hidden');
                
                // Start real-time updates
                startRealtimeUpdates();
                
                // Initialize charts
                setTimeout(initializeCharts, 500);
                
                console.log('✅ Admin login successful');
            } else {
                errorElement.classList.remove('hidden');
                console.log('❌ Admin login failed');
            }
        }

        function logoutAdmin() {
            AdminState.isLoggedIn = false;
            sessionStorage.removeItem('adminLoggedIn');
            
            // Destroy charts
            Object.values(AdminState.charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
            AdminState.charts = {};
            
            document.getElementById('adminPage').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('adminPassword').value = 'admin123';
            document.getElementById('loginError').classList.add('hidden');
            
            console.log('✅ Admin logout successful');
        }

        // Enhanced Admin Functions with Mobile Support
        function clearAllUserData() {
            if (confirm('🚨 SUPER ADMIN ACTION: This will delete ALL user data across the entire platform. This cannot be undone!')) {
                try {
                    // Clear all localStorage
                    const keys = Object.keys(localStorage);
                    let clearedCount = 0;
                    keys.forEach(key => {
                        if (key.startsWith('aihug_') || key.startsWith('aiHugMeUser')) {
                            localStorage.removeItem(key);
                            clearedCount++;
                        }
                    });
                    
                    console.log(`All user data cleared: ${clearedCount} items removed`);
                    showTemporaryMessage(`✅ ALL user data cleared successfully! ${clearedCount} items removed`, 'success');
                    
                    // Track this admin action
                    if (window.analyticsManager) {
                        window.analyticsManager.trackEvent('admin_action', {
                            action: 'clear_all_user_data',
                            admin: 'super_admin',
                            items_cleared: clearedCount
                        });
                    }
                } catch (error) {
                    console.error('Error clearing user data:', error);
                    showTemporaryMessage('❌ Error clearing user data', 'error');
                }
            }
        }

        function emergencyShutdown() {
            if (confirm('🚨 EMERGENCY SHUTDOWN: This will disable the entire website for all users! Are you sure?')) {
                try {
                    const settings = JSON.parse(localStorage.getItem('aiHugMeSiteSettings') || '{}');
                    settings.emergencyShutdown = true;
                    settings.shutdownMessage = "Website temporarily unavailable for maintenance.";
                    settings.shutdownTime = new Date().toISOString();
                    localStorage.setItem('aiHugMeSiteSettings', JSON.stringify(settings));
                    
                    showTemporaryMessage('🚨 EMERGENCY SHUTDOWN ACTIVATED! Website is now disabled.', 'success');
                    
                    // Track shutdown event
                    if (window.analyticsManager) {
                        window.analyticsManager.trackEvent('admin_action', {
                            action: 'emergency_shutdown',
                            admin: 'super_admin',
                            timestamp: new Date().toISOString()
                        });
                    }
                } catch (error) {
                    console.error('Error during emergency shutdown:', error);
                    showTemporaryMessage('❌ Error activating emergency shutdown', 'error');
                }
            }
        }

        function exportAllUserData() {
            try {
                // In a real app, this would export all user data
                const exportData = {
                    timestamp: new Date().toISOString(),
                    totalUsers: document.getElementById('totalUsersCount').textContent,
                    totalHugs: document.getElementById('totalHugs').textContent,
                    exportType: 'complete_user_data',
                    admin: 'super_admin'
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `ai-hug-me-complete-export-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showTemporaryMessage('✅ Complete user data export started!', 'success');
            } catch (error) {
                console.error('Error exporting data:', error);
                showTemporaryMessage('❌ Error exporting data', 'error');
            }
        }

        function sendNotification() {
            const message = prompt('Enter notification message for all users:');
            if (message) {
                try {
                    // In a real app, this would send push notifications
                    console.log('Notification sent to all users:', message);
                    
                    // Save notification to settings
                    const settings = JSON.parse(localStorage.getItem('aiHugMeSiteSettings') || '{}');
                    settings.lastNotification = {
                        message: message,
                        timestamp: new Date().toISOString(),
                        sentBy: 'admin'
                    };
                    localStorage.setItem('aiHugMeSiteSettings', JSON.stringify(settings));
                    
                    showTemporaryMessage(`✅ Notification sent: "${message}"`, 'success');
                } catch (error) {
                    console.error('Error sending notification:', error);
                    showTemporaryMessage('❌ Error sending notification', 'error');
                }
            }
        }

        function deleteInactiveUsers() {
            if (confirm('Delete all users inactive for more than 30 days?')) {
                try {
                    // In a real app, this would delete from storage
                    console.log('Inactive users deletion process started');
                    
                    // Simulate deletion
                    setTimeout(() => {
                        showTemporaryMessage('✅ Inactive users deletion process completed!', 'success');
                    }, 2000);
                    
                } catch (error) {
                    console.error('Error deleting inactive users:', error);
                    showTemporaryMessage('❌ Error deleting inactive users', 'error');
                }
            }
        }

        function showTemporaryMessage(message, type, duration = 5000) {
            const messageElement = document.createElement('div');
            messageElement.className = type === 'success' ? 'success-message' : 'error-message';
            messageElement.innerHTML = message;
            
            messageElement.style.position = 'fixed';
            messageElement.style.top = '20px';
            messageElement.style.right = '20px';
            messageElement.style.zIndex = '10000';
            messageElement.style.minWidth = '300px';
            messageElement.style.maxWidth = '90vw';
            
            document.body.appendChild(messageElement);
            
            setTimeout(() => {
                if (messageElement.parentNode) {
                    messageElement.parentNode.removeChild(messageElement);
                }
            }, duration);
        }

        // Footer Management Functions
        function loadFooterSettings() {
            const footerText = document.getElementById('footerText');
            const footerLinksContainer = document.getElementById('footerLinksContainer');
            const footerPreview = document.getElementById('footerPreview');
            
            if (footerText) {
                footerText.value = AdminState.adminData.footerSettings.text;
            }
            
            renderFooterLinks();
            updateFooterPreview();
        }

        function renderFooterLinks() {
            const footerLinksContainer = document.getElementById('footerLinksContainer');
            if (!footerLinksContainer) return;
            
            footerLinksContainer.innerHTML = '';
            
            AdminState.footerLinks.forEach((link, index) => {
                const linkElement = document.createElement('div');
                linkElement.className = 'footer-link-item';
                linkElement.innerHTML = `
                    <div class="footer-link-inputs">
                        <input type="text" class="form-control" value="${link.text}" placeholder="Link Text" onchange="updateFooterLink(${index}, 'text', this.value)">
                        <input type="text" class="form-control" value="${link.href}" placeholder="Link URL" onchange="updateFooterLink(${index}, 'href', this.value)">
                        <input type="text" class="form-control" value="${link.id}" placeholder="Link ID" onchange="updateFooterLink(${index}, 'id', this.value)">
                    </div>
                    <div class="footer-link-actions">
                        <button class="btn btn-sm btn-danger" onclick="removeFooterLink(${index})">✕</button>
                        <button class="btn btn-sm btn-secondary" onclick="moveFooterLinkUp(${index})" ${index === 0 ? 'disabled' : ''}>↑</button>
                        <button class="btn btn-sm btn-secondary" onclick="moveFooterLinkDown(${index})" ${index === AdminState.footerLinks.length - 1 ? 'disabled' : ''}>↓</button>
                    </div>
                `;
                footerLinksContainer.appendChild(linkElement);
            });
        }

        function addFooterLink() {
            AdminState.footerLinks.push({
                text: "New Link",
                href: "#",
                id: "newLink"
            });
            renderFooterLinks();
            updateFooterPreview();
        }

        function removeFooterLink(index) {
            AdminState.footerLinks.splice(index, 1);
            renderFooterLinks();
            updateFooterPreview();
        }

        function updateFooterLink(index, field, value) {
            AdminState.footerLinks[index][field] = value;
            updateFooterPreview();
        }

        function moveFooterLinkUp(index) {
            if (index > 0) {
                const temp = AdminState.footerLinks[index];
                AdminState.footerLinks[index] = AdminState.footerLinks[index - 1];
                AdminState.footerLinks[index - 1] = temp;
                renderFooterLinks();
                updateFooterPreview();
            }
        }

        function moveFooterLinkDown(index) {
            if (index < AdminState.footerLinks.length - 1) {
                const temp = AdminState.footerLinks[index];
                AdminState.footerLinks[index] = AdminState.footerLinks[index + 1];
                AdminState.footerLinks[index + 1] = temp;
                renderFooterLinks();
                updateFooterPreview();
            }
        }

        function updateFooterPreview() {
            const footerPreview = document.getElementById('footerPreview');
            if (!footerPreview) return;
            
            const linksHTML = AdminState.footerLinks.map(link => 
                `<a href="${link.href}" id="${link.id}" style="color: #6a11cb; text-decoration: none; margin: 0 10px; font-weight: 500;">${link.text}</a>`
            ).join('');
            
            footerPreview.innerHTML = `
                <div style="text-align: center; margin-bottom: 10px;">
                    ${linksHTML}
                </div>
                <div style="text-align: center; color: #666; font-size: 0.85rem;">
                    ${document.getElementById('footerText').value}
                </div>
            `;
        }

        function saveFooterSettings() {
            try {
                AdminState.adminData.footerSettings.text = document.getElementById('footerText').value;
                AdminState.adminData.footerSettings.links = AdminState.footerLinks;
                
                localStorage.setItem('aiHugMeAdminData', JSON.stringify(AdminState.adminData));
                
                // Also save to site settings for frontend
                const siteSettings = JSON.parse(localStorage.getItem('aiHugMeSiteSettings') || '{}');
                siteSettings.footerText = AdminState.adminData.footerSettings.text;
                siteSettings.footerLinks = AdminState.adminData.footerSettings.links.map(link => 
                    `<a href="${link.href}" id="${link.id}">${link.text}</a>`
                ).join('');
                localStorage.setItem('aiHugMeSiteSettings', JSON.stringify(siteSettings));
                
                showTemporaryMessage('✅ Footer settings saved successfully!', 'success');
            } catch (error) {
                console.error('Error saving footer settings:', error);
                showTemporaryMessage('❌ Error saving footer settings', 'error');
            }
        }

        function applySiteSettings() {
            try {
                const siteTitle = document.getElementById('siteTitle').value;
                const siteTagline = document.getElementById('siteTagline').value;
                const themeColor = document.getElementById('themeColor').value;
                const newPassword = document.getElementById('newPassword').value;
                
                const settings = {
                    siteTitle,
                    siteTagline,
                    themeColor,
                    features: {
                        enableSpecialEvents: document.getElementById('enableSpecialEvents').checked,
                        enableSocialSharing: document.getElementById('enableSocialSharing').checked,
                        enableViralFeatures: document.getElementById('enableViralFeatures').checked,
                        enableUserTracking: document.getElementById('enableUserTracking').checked
                    },
                    updatedAt: new Date().toISOString()
                };
                
                if (newPassword) {
                    AdminState.adminData.password = newPassword;
                    localStorage.setItem('aiHugMeAdminData', JSON.stringify(AdminState.adminData));
                    document.getElementById('newPassword').value = '';
                }
                
                localStorage.setItem('aiHugMeSiteSettings', JSON.stringify(settings));
                showTemporaryMessage('✅ Site settings applied successfully!', 'success');
                
            } catch (error) {
                console.error('Error applying site settings:', error);
                showTemporaryMessage('❌ Error applying site settings', 'error');
            }
        }

        function resetSiteSettings() {
            if (confirm('Reset all site settings to default?')) {
                localStorage.removeItem('aiHugMeSiteSettings');
                loadCurrentSettings();
                showTemporaryMessage('✅ Site settings reset to default!', 'success');
            }
        }

        function loadCurrentSettings() {
            try {
                const settings = JSON.parse(localStorage.getItem('aiHugMeSiteSettings') || '{}');
                
                if (settings.siteTitle) document.getElementById('siteTitle').value = settings.siteTitle;
                if (settings.siteTagline) document.getElementById('siteTagline').value = settings.siteTagline;
                if (settings.themeColor) document.getElementById('themeColor').value = settings.themeColor;
                
                if (settings.features) {
                    document.getElementById('enableSpecialEvents').checked = settings.features.enableSpecialEvents !== false;
                    document.getElementById('enableSocialSharing').checked = settings.features.enableSocialSharing !== false;
                    document.getElementById('enableViralFeatures').checked = settings.features.enableViralFeatures !== false;
                    document.getElementById('enableUserTracking').checked = settings.features.enableUserTracking !== false;
                }
                
                // Load page content
                if (AdminState.adminData.pageContent) {
                    document.getElementById('aboutPageContent').value = AdminState.adminData.pageContent.about;
                    document.getElementById('termsPageContent').value = AdminState.adminData.pageContent.terms;
                    document.getElementById('privacyPageContent').value = AdminState.adminData.pageContent.privacy;
                    document.getElementById('contactPageContent').value = AdminState.adminData.pageContent.contact;
                }
                
            } catch (error) {
                console.error('Error loading current settings:', error);
            }
        }

        function savePageContent() {
            try {
                AdminState.adminData.pageContent = {
                    about: document.getElementById('aboutPageContent').value,
                    terms: document.getElementById('termsPageContent').value,
                    privacy: document.getElementById('privacyPageContent').value,
                    contact: document.getElementById('contactPageContent').value
                };
                
                localStorage.setItem('aiHugMeAdminData', JSON.stringify(AdminState.adminData));
                
                // Also save to separate storage for frontend
                localStorage.setItem('aiHugMePageContent', JSON.stringify(AdminState.adminData.pageContent));
                
                showTemporaryMessage('✅ Page content saved successfully!', 'success');
                
            } catch (error) {
                console.error('Error saving page content:', error);
                showTemporaryMessage('❌ Error saving page content', 'error');
            }
        }

        // Page management quick actions
        function loadAllPages() {
            loadCurrentSettings();
            showTemporaryMessage('✅ All pages loaded from storage!', 'success');
        }

        function saveAllPages() {
            savePageContent();
        }

        function resetPages() {
            if (confirm('Reset all page content to default?')) {
                initializeAdminData();
                loadCurrentSettings();
                showTemporaryMessage('✅ All pages reset to default!', 'success');
            }
        }

        function previewPages() {
            showTemporaryMessage('👁️ Preview feature would open in new tab', 'success');
        }

        function searchUsers() {
            const query = document.getElementById('userSearch').value;
            if (query) {
                showTemporaryMessage(`🔍 Searching for: ${query}`, 'success');
            }
        }

        function refreshStats() {
            updateDashboardStats();
            showTemporaryMessage('✅ Stats refreshed!', 'success');
        }

        function exportReport() {
            const reportData = {
                timestamp: new Date().toISOString(),
                totalHugs: document.getElementById('totalHugs').textContent,
                activeUsers: document.getElementById('activeUsers').textContent,
                totalRevenue: document.getElementById('todayRevenue').textContent
            };
            
            const dataStr = JSON.stringify(reportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `ai-hug-me-report-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showTemporaryMessage('✅ Report exported successfully!', 'success');
        }

        // Enhanced charts initialization
        function initializeCharts() {
            try {
                // Real-time chart
                const realtimeCtx = document.getElementById('realtimeChart');
                if (realtimeCtx) {
                    if (AdminState.charts.realtime) {
                        AdminState.charts.realtime.destroy();
                    }
                    
                    AdminState.charts.realtime = new Chart(realtimeCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: Array.from({length: 12}, (_, i) => `${i*2}:00`),
                            datasets: [{
                                label: 'Hugs per 2 Hours',
                                data: Array.from({length: 12}, () => Math.floor(Math.random() * 50) + 10),
                                borderColor: '#ff6b6b',
                                backgroundColor: 'rgba(255, 107, 107, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { 
                                legend: { display: false },
                                title: { display: false }
                            }
                        }
                    });
                }
                
                // Enhanced analytics chart
                const analyticsCtx = document.getElementById('analyticsChart');
                if (analyticsCtx) {
                    if (AdminState.charts.analytics) {
                        AdminState.charts.analytics.destroy();
                    }
                    
                    AdminState.charts.analytics = new Chart(analyticsCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['Hugs', 'Sessions', 'Users', 'Revenue', 'Ads'],
                            datasets: [{
                                label: 'Today',
                                data: [125, 89, 45, 12.50, 23],
                                backgroundColor: '#6a11cb'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                }
                
                // User growth chart
                const userGrowthCtx = document.getElementById('userGrowthChart');
                if (userGrowthCtx) {
                    if (AdminState.charts.userGrowth) {
                        AdminState.charts.userGrowth.destroy();
                    }
                    
                    AdminState.charts.userGrowth = new Chart(userGrowthCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            datasets: [{
                                label: 'New Users',
                                data: [45, 62, 78, 95, 112, 145],
                                borderColor: '#28a745',
                                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                }
            } catch (error) {
                console.error("Chart initialization error:", error);
            }
        }

        // Make functions available globally
        window.toggleAdSlot = toggleAdSlot;
        window.deleteAdSlot = deleteAdSlot;
        window.switchTab = switchTab;
        window.loadAllPages = loadAllPages;
        window.saveAllPages = saveAllPages;
        window.resetPages = resetPages;
        window.previewPages = previewPages;
        window.searchUsers = searchUsers;
        window.refreshStats = refreshStats;
        window.exportReport = exportReport;
        window.addFooterLink = addFooterLink;
        window.removeFooterLink = removeFooterLink;
        window.updateFooterLink = updateFooterLink;
        window.moveFooterLinkUp = moveFooterLinkUp;
        window.moveFooterLinkDown = moveFooterLinkDown;
    </script>

    <!-- Load analytics manager -->
    <script src="analytics-manager.js"></script>
</body>
</html>